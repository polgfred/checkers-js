(()=>{"use strict";var t,n;function e(e,r){return e===t.RED&&r===n.RED_PIECE||e===t.WHT&&r===n.WHT_PIECE}function r(e,r){return e===t.RED&&r===n.RED_KING||e===t.WHT&&r===n.WHT_KING}!function(t){t[t.RED=1]="RED",t[t.WHT=-1]="WHT"}(t||(t={})),function(t){t[t.EMPTY=0]="EMPTY",t[t.RED_PIECE=1]="RED_PIECE",t[t.RED_KING=2]="RED_KING",t[t.RED_EITHER=3]="RED_EITHER",t[t.WHT_PIECE=-1]="WHT_PIECE",t[t.WHT_KING=-2]="WHT_KING",t[t.WHT_EITHER=-3]="WHT_EITHER"}(n||(n={}));const o=f(new ArrayBuffer(64));function s(t){return f(t[0].buffer.slice(0))}function f(t){return[new Int8Array(t,0,8),new Int8Array(t,8,8),new Int8Array(t,16,8),new Int8Array(t,24,8),new Int8Array(t,32,8),new Int8Array(t,40,8),new Int8Array(t,48,8),new Int8Array(t,56,8)]}o[0][0]=o[0][2]=o[0][4]=o[0][6]=1,o[1][1]=o[1][3]=o[1][5]=o[1][7]=1,o[2][0]=o[2][2]=o[2][4]=o[2][6]=1,o[5][1]=o[5][3]=o[5][5]=o[5][7]=-1,o[6][0]=o[6][2]=o[6][4]=o[6][6]=-1,o[7][1]=o[7][3]=o[7][5]=o[7][7]=-1;const{RED:c}=t,{EMPTY:l}=n;const{EMPTY:u,WHT_PIECE:E,WHT_KING:i,WHT_EITHER:a,RED_PIECE:d,RED_KING:I,RED_EITHER:T}=n;const R=function(){const t=[[],[],[],[],[],[],[],[]];return{getScores:()=>t,addFormation:function(n,e){for(let r=0;r<8;++r)for(let o=0;o<8;++o){const s=e[r][o];0!==s&&(t[r][o]=t[r][o]||[],t[r][o].push([n,s]))}},evaluate:function(n){let e=0;for(let r=0;r<8;++r)for(let o=0;o<8;++o){const s=t[r][o];if(s)for(let t=0;t<s.length;++t){const[f,c]=s[t];let l;l=!0;for(let t=0;t<f.length;++t){const[e,s,c]=f[t],R=n[r+s][o+e];if((c!==u||R!==u)&&(c!==d&&c!==T||R!==d)&&(c!==I&&c!==T||R!==I)&&(c!==E&&c!==a||R!==E)&&(c!==i&&c!==a||R!==i)){l=!1;break}}l&&(e+=c),l=!0;for(let t=0;t<f.length;++t){const[e,s,c]=f[t],R=n[(7^r)-s][(7^o)-e];if((c!==u||R!==u)&&(c!==d&&c!==T||R!==E)&&(c!==I&&c!==T||R!==i)&&(c!==E&&c!==a||R!==d)&&(c!==i&&c!==a||R!==I)){l=!1;break}}l&&(e-=c)}}return e}}}();R.addFormation([[0,0,1]],[[0,0,0,0,0,0,0,0],[50,0,50,0,50,0,50,0],[0,50,0,50,0,50,0,50],[50,0,50,0,50,0,50,0],[0,50,0,50,0,50,0,50],[50,0,50,0,50,0,50,0],[0,50,0,50,0,50,0,50],[50,0,50,0,50,0,50,0]].reverse()),R.addFormation([[0,0,2]],[[0,60,0,60,0,60,0,60],[60,0,60,0,60,0,60,0],[0,60,0,60,0,60,0,60],[60,0,60,0,60,0,60,0],[0,60,0,60,0,60,0,60],[60,0,60,0,60,0,60,0],[0,60,0,60,0,60,0,60],[60,0,60,0,60,0,60,0]].reverse()),R.addFormation([[0,0,3],[1,-1,3]],[[0,12,0,8,0,0,0,0],[12,0,10,0,6,0,0,0],[0,10,0,8,0,4,0,0],[8,0,8,0,6,0,2,0],[0,6,0,6,0,4,0,0],[0,0,4,0,4,0,2,0],[0,0,0,2,0,2,0,0],[0,0,0,0,0,0,0,0]].reverse()),R.addFormation([[0,0,3],[1,-1,3],[2,-2,3]],[[0,12,0,8,0,0,0,0],[12,0,10,0,6,0,0,0],[0,10,0,8,0,4,0,0],[8,0,8,0,6,0,0,0],[0,6,0,6,0,4,0,0],[0,0,4,0,4,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]].reverse()),R.addFormation([[0,0,3],[1,-1,3],[-1,-1,3]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,12,0,8,0,4,0],[0,8,0,12,0,8,0,0],[0,0,8,0,12,0,8,0],[0,4,0,12,0,12,0,0],[0,0,0,0,0,0,0,0]].reverse()),R.addFormation([[0,0,3],[-1,-1,3]],[[0,0,0,0,0,10,0,16],[0,0,0,0,8,0,12,0],[0,0,0,6,0,10,0,10],[0,0,4,0,8,0,8,0],[0,2,0,6,0,6,0,0],[0,0,4,0,4,0,0,0],[0,2,0,2,0,0,0,0],[0,0,0,0,0,0,0,0]].reverse()),R.addFormation([[0,0,3],[-1,-1,3],[-2,-2,3]],[[0,0,0,0,0,10,0,16],[0,0,0,0,8,0,12,0],[0,0,0,6,0,10,0,10],[0,0,4,0,8,0,8,0],[0,0,0,6,0,6,0,0],[0,0,4,0,4,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]].reverse());const H=R,{RED:_,WHT:g}=t;function D(t,n,o=H){const{getBoard:f,getSide:u,findJumps:E,doJump:i,findMoves:a,doMove:d}=function(t,n){const o=s(t);function f(){const t=n===c?7:0,e=t+n,r=7^t,s=[];for(let t=r;t!==e;t+=n)for(let f=r;f!==e;f+=n){const e=o[t][f];(n===c?e>0:e<0)&&u([[f,t]],s)}return s}function u(t,e){const[s,f]=t[t.length-1],E=o[f][s],i=n===c?7:0,a=r(n,E);let d=!1;for(let r=a?-1:1;r<=1;r+=2)for(let I=-1;I<=1;I+=2){let T,R,H,_;if(1===n?(T=s+I,R=f+r,H=T+I,_=R+r):(T=s-I,R=f-r,H=T-I,_=R-r),H>=0&&H<8&&_>=0&&_<8){const r=o[R][T];if(o[_][H]===l&&(n===c?r<0:r>0)){const n=!a&&_===i;d=!0,o[f][s]=l,o[R][T]=l,o[_][H]=n?E<<1:E,t.push([H,_,T,R]),!n&&u(t,e)||e.push(t.slice()),t.pop(),o[f][s]=E,o[R][T]=r,o[_][H]=l}}}return d}function E(t){const r=t.length,[s,f]=t[0],[u,E]=t[r-1],i=o[f][s],a=n===c?7:0,d=e(n,i)&&E===a,I=new Array(r);I[0]=i,o[f][s]=l;for(let n=1;n<r;++n){const[,,e,r]=t[n];I[n]=o[r][e],o[r][e]=l}return o[E][u]=d?i<<1:i,n=-n,()=>{o[E][u]=l;for(let n=r-1;n>0;--n){const[,,e,r]=t[n];o[r][e]=I[n]}o[f][s]=i,n=-n}}function i(){const t=n===c?7:0,e=t+n,s=7^t,f=[];for(let t=s;t!==e;t+=n)for(let u=s;u!==e;u+=n){const e=o[t][u],s=r(n,e);if(n===c?e>0:e<0)for(let e=s?-1:1;e<=1;e+=2)for(let r=-1;r<=1;r+=2){let s,E;n===c?(s=u+r,E=t+e):(s=u-r,E=t-e),s>=0&&s<8&&E>=0&&E<8&&o[E][s]===l&&f.push([[u,t],[s,E]])}}return f}function a(t){const[[r,s],[f,u]]=t,E=o[s][r],i=n===c?7:0,a=e(n,E)&&u===i;return o[s][r]=l,o[u][f]=a?E<<1:E,n=-n,()=>{o[u][f]=l,o[s][r]=E,n=-n}}function d(){const t=f();return t.length?t:i()}return{getBoard:()=>o,getSide:()=>n,findJumps:f,findMoves:i,findPlays:d,doJump:E,doMove:a,doPlay:function(t){return t[1].length>2?E(t):a(t)},buildTree:function(){const t=d(),n={};for(let e=0;e<t.length;++e){const r=t[e];let o=n;for(let t=0;t<r.length;++t){const[n,e]=r[t],s=`${n},${e}`;o[s]=o[s]||{},o=o[s]}}return n}}}(t,n);return function t(n){const e=f(),r=u();let s,c,l=r/-0;const I=E();if(I.length)for(let e=0;e<I.length;++e){const o=I[e],f=i(o);c=t(n-1)[1],f(),(r===_&&c>l||r===g&&c<l)&&(s=o,l=c)}else if(n>0){const e=a();for(let o=0;o<e.length;++o){const f=e[o],u=d(f);c=t(n-1)[1],u(),(r===_&&c>l||r===g&&c<l)&&(s=f,l=c)}}else l=o.evaluate(e);return[s,l]}(8)}self.addEventListener("message",(t=>{const{board:n,side:e}=t.data,[r]=D(n,e);self.postMessage({move:r})}),!1)})();
//# sourceMappingURL=worker-bundle.js.map